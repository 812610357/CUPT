import math
import matplotlib.pyplot as plt
import numpy as np
from scipy.optimize import curve_fit
from matplotlib.font_manager import FontProperties
font_zh = FontProperties(
    fname="/home/zgb/ojy/simhei.ttf")  # 导入中文字体
plt.rcParams['axes.unicode_minus'] = False  # 用来正常显示负号

data = np.array([
    [0.067, 	0.848],
    [0.083, 	-1.540],
    [0.100, 	-3.966],
    [0.117, 	-6.154],
    [0.133, 	-8.464],
    [0.150, 	-10.729],
    [0.167, 	-12.864],
    [0.184, 	-15.081],
    [0.200, 	-17.131],
    [0.217, 	-19.071],
    [0.234, 	-20.834],
    [0.250, 	-22.515],
    [0.267, 	-24.128],
    [0.284, 	-25.610],
    [0.300, 	-26.961],
    [0.317, 	-28.207],
    [0.334, 	-29.237],
    [0.350, 	-30.073],
    [0.367, 	-30.679],
    [0.384, 	-31.121],
    [0.400, 	-31.415],
    [0.417,     -31.538],
    [0.434, 	-31.491],
    [0.450, 	-31.314],
    [0.467, 	-30.886],
    [0.484, 	-30.317],
    [0.501, 	-29.549],
    [0.517, 	-28.569],
    [0.534, 	-27.402],
    [0.551, 	-26.087],
    [0.567, 	-24.602],
    [0.584, 	-22.972],
    [0.601, 	-21.280],
    [0.617, 	-19.447],
    [0.634, 	-17.411],
    [0.651, 	-15.320],
    [0.667, 	-13.152],
    [0.684, 	-10.899],
    [0.701, 	-8.618],
    [0.717, 	-6.240],
    [0.734, 	-3.867],
    [0.751, 	-1.381],
    [0.767, 	1.048],
    [0.784, 	3.511],
    [0.801, 	6.047],
    [0.817, 	8.508],
    [0.834, 	10.991],
    [0.851, 	13.219],
    [0.868, 	15.200],
    [0.884, 	17.136],
    [0.901, 	19.002],
    [0.918, 	20.875],
    [0.934, 	22.574],
    [0.951, 	24.130],
    [0.968, 	25.586],
    [0.984, 	26.915],
    [1.001, 	28.311],
    [1.018, 	29.057],
    [1.034, 	30.105],
    [1.051, 	30.901],
    [1.068, 	31.507],
    [1.084, 	31.930],
    [1.101, 	32.049],
    [1.118, 	32.257],
    [1.134, 	32.047],
    [1.151, 	31.806],
    [1.168, 	31.342],
    [1.185, 	30.764],
    [1.201, 	29.922],
    [1.218, 	28.957],
    [1.235, 	27.810],
    [1.251, 	26.448],
    [1.268, 	24.950],
    [1.285, 	23.391],
    [1.301, 	21.665],
    [1.318, 	19.873],
    [1.335, 	17.997],
    [1.351, 	16.003],
    [1.368, 	14.387],
    [1.385, 	11.710],
    [1.401, 	9.282],
    [1.418, 	7.018],
    [1.435, 	4.742],
    [1.451, 	2.240],
    [1.468, 	-0.000],
    [1.485, 	-2.560],
    [1.502, 	-4.927],
    [1.518, 	-7.179],
    [1.535, 	-9.504],
    [1.552, 	-11.912],
    [1.568, 	-13.941],
    [1.585, 	-16.159],
    [1.602, 	-18.144],
    [1.618, 	-20.143],
    [1.635, 	-21.671],
    [1.652, 	-23.194],
    [1.668, 	-24.757],
    [1.685, 	-26.190],
    [1.702, 	-27.453],
    [1.718,	    -28.552],
    [1.735,	    -29.480],
    [1.752,	    -30.295],
    [1.768,	    -30.837],
    [1.785,	    -31.176],
    [1.802, 	-31.280],
    [1.818, 	-31.242],
    [1.835, 	-31.112],
    [1.852, 	-30.802],
    [1.869, 	-30.264],
    [1.885, 	-29.558],
    [1.902, 	-28.671],
    [1.919, 	-27.579],
    [1.935, 	-26.319],
    [1.952, 	-24.945],
    [1.969, 	-23.392],
    [1.985, 	-21.768]
])


def func(x, a, b, c, d):
    return a*np.sin(b*(x+c))+d


x0 = np.array(data[:, 0])
y0 = np.array(data[:, 1])
x = np.linspace(0, 2, 200)

popt, pcov = curve_fit(func, x0, y0)
a = popt[0]
b = popt[1]
c = popt[2]
d = popt[3]
y = func(x, a, b, c, d)

plt.scatter(x0, y0, marker='o', c='r')
plt.plot(x, y, 'b')
plt.show()
